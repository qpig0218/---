<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>法說會全方位解析：理論、實務與策略應用</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutral Harmony -->
    <!-- Application Structure Plan: A thematic, non-linear SPA with five sections: Introduction, The Playbook, Case Studies, Analyst's Toolkit, and The Future. This structure is chosen to allow users to explore concepts based on interest (e.g., 'how to do it' vs. 'how to analyze it') rather than a rigid report format. Key interaction is the 'Case Studies' dashboard, where users can click on company logos to get a detailed breakdown and see a comparative chart, fostering direct engagement and comparison. -->
    <!-- Visualization & Content Choices: Report Info: Six Taiwanese company analyses -> Goal: Compare performance -> Viz/Method: Interactive dashboard with clickable logos and a comparative radar chart -> Interaction: User selects a company to view its specific strengths/weaknesses and sees its relative standing on the chart across five dimensions. -> Justification: The radar chart provides a better multi-dimensional comparison than a bar chart for these qualitative scores. -> Library: Chart.js. Report Info: Strategic frameworks (Pyramid, 3x3 grid) -> Goal: Explain complex concepts -> Viz/Method: Interactive diagrams built with HTML/CSS -> Interaction: Hover or click to reveal details -> Justification: Breaks down dense theory into digestible, user-paced learning chunks. -> Library/Method: Vanilla JS + Tailwind CSS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #F8F5F2;
            color: #333333;
        }
        .nav-link {
            transition: color 0.3s, border-bottom-color 0.3s;
            border-bottom: 2px solid transparent;
        }
        .nav-link:hover, .nav-link.active {
            color: #4A7C59;
            border-bottom-color: #4A7C59;
        }
        .mobile-nav-link.active {
            background-color: #E8F1E9;
            color: #4A7C59;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .card {
            background-color: #FFFFFF;
            border: 1px solid #EAEAEA;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        .company-logo {
            filter: grayscale(100%);
            transition: all 0.3s;
            cursor: pointer;
            opacity: 0.7;
            border: 3px solid transparent;
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            min-width: 120px;
            text-align: center;
            flex: 0 0 220px;
        }
        .company-logo img {
            max-height: 3rem;
        }
        .company-symbol {
            width: 3rem;
            height: 3rem;
            border-radius: 9999px;
            background: linear-gradient(135deg, #f0fdf4, #d9ead3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #2f3c32;
            font-size: 1rem;
            letter-spacing: 0.05em;
            box-shadow: inset 0 0 0 1px rgba(74, 124, 89, 0.1);
        }
        .company-name {
            font-size: 0.875rem;
            font-weight: 600;
            color: #2f3c32;
            line-height: 1.4;
            white-space: nowrap;
        }
        .company-logo:hover {
            filter: grayscale(0%);
            opacity: 1;
        }
        .company-logo.selected {
            filter: grayscale(0%);
            opacity: 1;
            border-color: #4A7C59;
            box-shadow: 0 0 15px rgba(74, 124, 89, 0.5);
            background-color: #f0fdf4;
        }
        .company-radar-wrapper {
            width: 100%;
            height: 200px;
        }
        .company-radar-wrapper canvas {
            width: 100% !important;
            height: 100% !important;
        }
        .tag {
            background-color: #E8F1E9;
            color: #4A7C59;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 50vh;
            max-height: 500px;
        }
    </style>
</head>
<body class="antialiased">
    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold text-[#4A7C59]">法說會全方位解析(財務報導作業)</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#intro" class="nav-link px-3 py-2 text-sm font-medium">法說會是什麼</a>
                        <a href="#playbook" class="nav-link px-3 py-2 text-sm font-medium">策略實戰手冊</a>
                        <a href="#cases" class="nav-link px-3 py-2 text-sm font-medium">經典案例剖析</a>
                        <a href="#toolkit" class="nav-link px-3 py-2 text-sm font-medium">投資人工具箱</a>
                        <a href="#future" class="nav-link px-3 py-2 text-sm font-medium">未來趨勢</a>
                    </div>
                </div>
                <div class="-mr-2 flex md:hidden">
                    <button id="mobile-menu-button" type="button" class="bg-white inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#4A7C59]">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" id="hamburger-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                        <svg class="hidden h-6 w-6" id="close-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
        </nav>
        <div class="md:hidden hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#intro" class="mobile-nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50">法說會是什麼</a>
                <a href="#playbook" class="mobile-nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50">策略實戰手冊</a>
                <a href="#cases" class="mobile-nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50">經典案例剖析</a>
                <a href="#toolkit" class="mobile-nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50">投資人工具箱</a>
                <a href="#future" class="mobile-nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50">未來趨勢</a>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <div id="intro" class="content-section">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800">解密法說會：企業與市場的關鍵對話</h2>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">法人說明會不僅是財報數字的公布，更是一場精心設計的策略溝通，旨在降低資訊不對稱、管理市場預期、並建立長期投資人信任。</p>
            </div>
            <div class="grid md:grid-cols-3 gap-8">
                <div class="card text-center">
                    <div class="text-4xl mb-4">🎯</div>
                    <h3 class="text-xl font-bold mb-2">降低資訊不對稱</h3>
                    <p class="text-gray-600">解決股東與經營層的資訊落差，提供比財報更深入的營運洞察，有效降低投資風險溢酬。</p>
                </div>
                <div class="card text-center">
                    <div class="text-4xl mb-4">📈</div>
                    <h3 class="text-xl font-bold mb-2">管理市場預期</h3>
                    <p class="text-gray-600">透過合理財務指引與風險邊界設定，引導投資者對公司價值的認知，減少股價意外波動。</p>
                </div>
                <div class="card text-center">
                    <div class="text-4xl mb-4">🤝</div>
                    <h3 class="text-xl font-bold mb-2">建立投資人信任</h3>
                    <p class="text-gray-600">展現管理層專業與誠信，強化公司治理形象，培養願意長期持有公司股票的忠實投資者。</p>
                </div>
            </div>
        </div>

        <div id="playbook" class="content-section">
             <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800">法說會策略實戰手冊</h2>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">成功法說會需要因應公司不同發展階段量身打造溝通策略。以下是針對三種典型情境的戰術。</p>
            </div>
            <div class="grid lg:grid-cols-3 gap-8">
                <div class="card">
                    <h3 class="font-bold text-xl mb-4 text-[#4A7C59]">🚀 高速成長期</h3>
                    <p class="font-semibold mb-2">核心要務：</p>
                    <p class="text-gray-600 mb-4">穩住單位經濟，設定務實的成長指引邊界，將市場領導地位轉化為品牌忠誠度。</p>
                    <p class="font-semibold mb-2">關鍵指標 (KPIs)：</p>
                    <ul class="list-disc list-inside text-gray-600 space-y-1">
                        <li>顧客終身價值 (LTV) / 獲客成本 (CAC)</li>
                        <li>淨收入留存率 (NRR)</li>
                        <li>用戶/營收同類群組分析 (Cohort Analysis)</li>
                        <li>Rule of 40 / Magic Number</li>
                    </ul>
                </div>
                <div class="card">
                    <h3 class="font-bold text-xl mb-4 text-[#4A7C59]">⚖️ 成熟轉型期</h3>
                    <p class="font-semibold mb-2">核心要務：</p>
                    <p class="text-gray-600 mb-4">清晰說明變革的理由與轉型藍圖，強調資本回報效率，並發掘第二成長曲線。</p>
                    <p class="font-semibold mb-2">關鍵指標 (KPIs)：</p>
                    <ul class="list-disc list-inside text-gray-600 space-y-1">
                        <li>股東回報政策 (股利、庫藏股)</li>
                        <li>營運現金流 / 自由現金流</li>
                        <li>費用率改善路徑</li>
                        <li>新業務投資回報率 (ROI)</li>
                    </ul>
                </div>
                 <div class="card">
                    <h3 class="font-bold text-xl mb-4 text-[#4A7C59]">⚠️ 逆風挑戰期</h3>
                    <p class="font-semibold mb-2">核心要務：</p>
                    <p class="text-gray-600 mb-4">坦誠透明面對問題，聚焦於可控因素的改善措施，並重申公司的長期基本面價值。</p>
                    <p class="font-semibold mb-2">關鍵指標 (KPIs)：</p>
                     <ul class="list-disc list-inside text-gray-600 space-y-1">
                        <li>現金轉換週期</li>
                        <li>資產品質與存貨天數</li>
                        <li>成本結構優化成果</li>
                        <li>市場份額穩定性</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="cases" class="content-section">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800">經典案例深度剖析</h2>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">從國際典範到台灣在地企業，學習成功經驗與失敗教訓。點擊下方企業標誌以查看詳細分析。</p>
            </div>
            <div class="bg-white p-6 rounded-xl shadow-md mb-8">
                <h3 class="font-bold text-xl mb-4 text-center">台灣六家企業法說會表現比較</h3>
                <div class="flex flex-nowrap gap-6 mb-8 items-start overflow-x-auto pb-4" id="company-selector">
                </div>
                <div id="company-details" class="mt-6 border-t pt-6">
                </div>
            </div>
            <div class="card">
                <h3 class="font-bold text-xl mb-4 text-center">綜合評分與比較雷達圖</h3>
                <div id="radarControls" class="flex flex-wrap justify-center gap-3 mb-4"></div>
                <div class="chart-container">
                    <canvas id="companyRadarChart"></canvas>
                </div>
                <p class="text-sm text-gray-500 mt-4 text-center">此圖表根據公開報告中的質化分析，將各公司在五個維度的表現量化評分(1-5分)，面積越大代表綜合表現越全面。</p>
            </div>
        </div>

        <div id="toolkit" class="content-section">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800">投資人工具箱：識破法說會的虛實</h2>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">結合語言分析的藝術與財務分析的科學，看穿經營層的弦外之音。</p>
            </div>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="card">
                    <h3 class="font-bold text-xl mb-4">🗣️ 敘事與語言紅旗</h3>
                    <ul class="space-y-3">
                        <li class="flex items-start">
                            <span class="text-red-500 mr-3 mt-1">🚩</span>
                            <span>只談GMV不談Take Rate，或用CAGR掩蓋近期疲軟。</span>
                        </li>
                        <li class="flex items-start">
                             <span class="text-red-500 mr-3 mt-1">🚩</span>
                            <span>過度使用「排除非經常性項目」調整，將常規費用當作一次性。</span>
                        </li>
                         <li class="flex items-start">
                             <span class="text-red-500 mr-3 mt-1">🚩</span>
                            <span>迴避具體問題，頻繁使用專業術語或委婉語。</span>
                        </li>
                         <li class="flex items-start">
                             <span class="text-red-500 mr-3 mt-1">🚩</span>
                            <span>聲學分析顯示，說服投資人時音調異常升高，或安撫時音調降低。</span>
                        </li>
                    </ul>
                </div>
                <div class="card">
                    <h3 class="font-bold text-xl mb-4">📊 財務數據紅旗</h3>
                     <ul class="space-y-3">
                        <li class="flex items-start">
                            <span class="text-red-500 mr-3 mt-1">🚩</span>
                            <span>淨利潤漂亮，但營運現金流持續為負或遠低於淨利。</span>
                        </li>
                        <li class="flex items-start">
                             <span class="text-red-500 mr-3 mt-1">🚩</span>
                            <span>應收帳款或存貨天數異常增長，與營收趨勢背離。</span>
                        </li>
                         <li class="flex items-start">
                             <span class="text-red-500 mr-3 mt-1">🚩</span>
                            <span>毛利率看似提升，但研發費用被大量資本化轉入資產。</span>
                        </li>
                         <li class="flex items-start">
                             <span class="text-red-500 mr-3 mt-1">🚩</span>
                            <span>Beneish M-Score > -2.22，顯示財報操縱嫌疑較高。</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div id="future" class="content-section">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800">法說會的未來：科技驅動的變革</h2>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">新技術正在重塑企業與投資者的溝通方式，法說會將變得更智慧、更整合、更具沉浸感。</p>
            </div>
            <div class="grid md:grid-cols-3 gap-8">
                <div class="card text-center">
                    <div class="text-4xl mb-4">🤖</div>
                    <h3 class="text-xl font-bold mb-2">AI 深度應用</h3>
                    <p class="text-gray-600">從即時多語言翻譯、管理層情緒分析預警，到個人化內容推薦和預測性Q&A準備，AI將大幅提升法說會的效率與深度。</p>
                </div>
                <div class="card text-center">
                    <div class="text-4xl mb-4">🌿</div>
                    <h3 class="text-xl font-bold mb-2">ESG 全面整合</h3>
                    <p class="text-gray-600">永續發展議題從選擇性揭露轉為必要要求。法說會需將ESG表現與財務績效有機結合，展現企業的長期價值創造能力。</p>
                </div>
                <div class="card text-center">
                    <div class="text-4xl mb-4">🌌</div>
                    <h3 class="text-xl font-bold mb-2">元宇宙沉浸式體驗</h3>
                    <p class="text-gray-600">虛擬實境(VR)技術將帶來革命性變化。投資人可透過虛擬化身進行工廠參觀、產品體驗，更直觀地了解企業營運實況。</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.nav-link');
            const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');
            const sections = document.querySelectorAll('.content-section');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            const hamburgerIcon = document.getElementById('hamburger-icon');
            const closeIcon = document.getElementById('close-icon');

            function updateActiveState() {
                let currentHash = window.location.hash || '#intro';
                
                navLinks.forEach(link => {
                    if (link.getAttribute('href') === currentHash) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });

                mobileNavLinks.forEach(link => {
                    if (link.getAttribute('href') === currentHash) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });

                sections.forEach(section => {
                    if ('#' + section.id === currentHash) {
                        section.classList.add('active');
                    } else {
                        section.classList.remove('active');
                    }
                });
            }

            function handleNavClick(e) {
                e.preventDefault();
                history.pushState(null, null, this.getAttribute('href'));
                updateActiveState();
            }

            navLinks.forEach(link => link.addEventListener('click', handleNavClick));
            mobileNavLinks.forEach(link => link.addEventListener('click', function(e) {
                handleNavClick.call(this, e);
                mobileMenu.classList.add('hidden');
                hamburgerIcon.classList.remove('hidden');
                closeIcon.classList.add('hidden');
            }));

            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
                hamburgerIcon.classList.toggle('hidden');
                closeIcon.classList.toggle('hidden');
            });

            window.addEventListener('popstate', updateActiveState);
            updateActiveState();

            function getSymbolText(name) {
                const trimmed = (name || '').trim();
                if (!trimmed) {
                    return '';
                }

                const isAscii = /^[\u0000-\u007F]+$/.test(trimmed);
                if (isAscii) {
                    const words = trimmed.split(/\s+/).filter(Boolean);
                    if (words.length === 1) {
                        return words[0].slice(0, 2).toUpperCase();
                    }
                    return words.map(word => word[0]).join('').slice(0, 2).toUpperCase();
                }

                return trimmed.slice(0, 2);
            }

            const companyData = {
                'linepay': { name: 'LINE Pay', logo: 'https://placehold.co/100x50/FFFFFF/000000?text=LINE+Pay&font=noto+sans+tc', tier: '第一梯隊', score: [5, 5, 5, 4, 5], analysis: { good: '展現最專業的表現，從虧損到獲利的數據故事線清晰，策略邏輯完整，視覺化呈現優秀。', bad: '缺乏與同業(如街口支付)的橫向比較，對未來支付生態系的競爭格局可以有更深入的論述。' }},
                'daiken': { name: '大研生醫', logo: 'https://placehold.co/100x50/FFFFFF/000000?text=%E5%A4%A7%E7%A0%94%E7%94%9F%E9%86%AB&font=noto+sans+tc', tier: '第二梯隊', score: [4, 4, 4, 2, 4], analysis: { good: '運用「七大戰略引擎」概念展現系統性思維，品牌代言人策略成功，營收與毛利表現亮眼。', bad: '對庫存週轉天數飆升(53→214天)與負債比率攀升(39%→67%)的風險溝通不足，需主動解釋。' }},
                'bafang': { name: '八方雲集', logo: 'https://placehold.co/100x50/FFFFFF/000000?text=%E5%85%AB%E6%96%B9%E9%9B%B2%E9%9B%86&font=noto+sans+tc', tier: '第三梯隊', score: [3, 3, 2, 2, 3], analysis: { good: '企業歷史脈絡與多品牌矩陣清晰，費用率管理穩定，區域佔比等數據透明。', bad: '近年食安事件的處理說明不夠充分，對負面消息的處理顯得被動，需要更積極的危機溝通策略。' }},
                'gogolook': { name: 'Gogolook', logo: 'https://placehold.co/100x50/FFFFFF/000000?text=Gogolook&font=noto+sans+tc', tier: '第三梯隊', score: [4, 3, 3, 2, 4], analysis: { good: '產業痛點與產品矩陣的敘事清楚，具備AI信任科技領導者的宏大願景與技術護城河。', bad: '市場預期管理面臨挑戰(年跌幅-42.57%)，需更有效解釋獲利轉機與國際擴張策略，將社會價值轉化為投資價值。' }},
                'chtsecurity': { name: '中華資安', logo: 'https://placehold.co/100x50/FFFFFF/000000?text=%E4%B8%AD%E8%8F%AF%E8%B3%87%E5%AE%89&font=noto+sans+tc', tier: '第二梯隊', score: [3, 4, 3, 4, 3], analysis: { good: '採用線上線下混合模式，漸進式資訊披露策略成功，有效覆蓋不同投資人，市場反應正面。', bad: '內容較為制式，可增加合約結構拆解(一次性 vs. 維運ARR)等更深入的財務指標，強化成長故事。' }},
                'dawushan': { name: '大武山', logo: 'https://placehold.co/100x50/FFFFFF/000000?text=%E5%A4%A7%E6%AD%A6%E5%B1%B1&font=noto+sans+tc', tier: '第三梯隊', score: [3, 2, 2, 2, 3], analysis: { good: '成功將傳統農業定位為科技升級股，展現差異化策略，品牌形象一致。', bad: '需更具體展示科技化升級的投資回報率(ROI)，並深化成本傳導機制(如飼料成本)與價格對沖策略的說明。' }},
            };

            const radarLabels = [
                '專業度與清晰度',
                '數據支撐完整性',
                '策略邏輯與願景',
                '風險溝通透明度',
                ['商業模式產品', '內容述說力']
            ];

            const chartFillColors = [
                'rgba(74, 124, 89, 0.4)',
                'rgba(54, 162, 235, 0.4)',
                'rgba(255, 206, 86, 0.4)',
                'rgba(255, 99, 132, 0.4)',
                'rgba(153, 102, 255, 0.4)',
                'rgba(255, 159, 64, 0.4)'
            ];

            const chartBorderColors = [
                'rgb(74, 124, 89)',
                'rgb(54, 162, 235)',
                'rgb(255, 206, 86)',
                'rgb(255, 99, 132)',
                'rgb(153, 102, 255)',
                'rgb(255, 159, 64)'
            ];

            const selectorContainer = document.getElementById('company-selector');
            const detailsContainer = document.getElementById('company-details');

            Object.keys(companyData).forEach((key, index) => {
                const company = companyData[key];
                const wrapper = document.createElement('div');
                wrapper.className = 'company-logo';
                wrapper.dataset.company = key;

                const symbolEl = document.createElement('div');
                symbolEl.className = 'company-symbol';
                symbolEl.textContent = getSymbolText(company.name);
                wrapper.appendChild(symbolEl);

                const nameEl = document.createElement('span');
                nameEl.textContent = company.name;
                nameEl.className = 'company-name';

                wrapper.appendChild(nameEl);
                const chartWrapper = document.createElement('div');
                chartWrapper.className = 'company-radar-wrapper';

                const chartCanvas = document.createElement('canvas');
                chartCanvas.id = `radar-${key}`;
                chartWrapper.appendChild(chartCanvas);

                wrapper.appendChild(chartWrapper);
                selectorContainer.appendChild(wrapper);

                const miniChartCtx = chartCanvas.getContext('2d');
                new Chart(miniChartCtx, {
                    type: 'radar',
                    data: {
                        labels: radarLabels,
                        datasets: [{
                            label: company.name,
                            data: company.score,
                            backgroundColor: chartFillColors[index % chartFillColors.length],
                            borderColor: chartBorderColors[index % chartBorderColors.length],
                            borderWidth: 2,
                            pointBackgroundColor: chartBorderColors[index % chartBorderColors.length]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        layout: {
                            padding: { top: 16, bottom: 16, left: 16, right: 16 }
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: { enabled: false }
                        },
                        scales: {
                            r: {
                                angleLines: { color: '#E5E7EB' },
                                suggestedMin: 0,
                                suggestedMax: 5,
                                ticks: {
                                    display: false
                                },
                                pointLabels: {
                                    font: {
                                        size: 10
                                    },
                                    color: '#4B5563',
                                    padding: 8
                                },
                                grid: {
                                    color: '#E5E7EB'
                                }
                            }
                        }
                    }
                });
            });
            
            selectorContainer.addEventListener('click', function(e) {
                const logoWrapper = e.target.closest('.company-logo');
                if(logoWrapper) {
                    const companyKey = logoWrapper.dataset.company;
                    
                    document.querySelectorAll('.company-logo').forEach(el => el.classList.remove('selected'));
                    logoWrapper.classList.add('selected');

                    displayCompanyDetails(companyKey);
                }
            });

            function displayCompanyDetails(key) {
                const company = companyData[key];
                detailsContainer.innerHTML = `
                    <div class="text-center">
                        <h4 class="text-2xl font-bold">${company.name}</h4>
                        <span class="tag mt-2 inline-block">${company.tier}</span>
                    </div>
                    <div class="grid md:grid-cols-2 gap-6 mt-6">
                        <div>
                            <h5 class="font-semibold text-lg mb-2 text-green-700">✅ 優點分析</h5>
                            <p class="text-gray-600">${company.analysis.good}</p>
                        </div>
                        <div>
                             <h5 class="font-semibold text-lg mb-2 text-red-700">⚠️ 改善建議</h5>
                            <p class="text-gray-600">${company.analysis.bad}</p>
                        </div>
                    </div>
                `;
            }
            
            const firstCompanyKey = Object.keys(companyData)[0];
            document.querySelector(`.company-logo[data-company="${firstCompanyKey}"]`).classList.add('selected');
            displayCompanyDetails(firstCompanyKey);
            
            const ctx = document.getElementById('companyRadarChart').getContext('2d');
            
            const radarDataSets = Object.values(companyData).map((company, index) => {
                return {
                    label: company.name,
                    data: company.score,
                    backgroundColor: chartFillColors[index % chartFillColors.length],
                    borderColor: chartBorderColors[index % chartBorderColors.length],
                    borderWidth: 2,
                    pointBackgroundColor: chartBorderColors[index % chartBorderColors.length]
                };
            });

            const companyRadarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: radarLabels,
                    datasets: radarDataSets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    layout: {
                        padding: { top: 24, bottom: 24, left: 24, right: 24 }
                    },
                    scales: {
                        r: {
                            angleLines: {
                                display: true
                            },
                            suggestedMin: 0,
                            suggestedMax: 5,
                            ticks: {
                                stepSize: 1,
                                backdropColor: 'rgba(255, 255, 255, 0.75)'
                            },
                            pointLabels: {
                                font: {
                                    size: 12
                                },
                                color: '#333',
                                padding: 12
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: '台灣六家企業法說會表現維度評分',
                             font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: function(tooltipItems) {
                                    const item = tooltipItems[0];
                                    let label = item.chart.data.labels[item.dataIndex];
                                    if (Array.isArray(label)) {
                                      return label.join(' ');
                                    }
                                    return label;
                                }
                            }
                        },
                        legend: {
                            position: 'top',
                        },
                    }
                }
            });

            const radarControlsContainer = document.getElementById('radarControls');
            radarDataSets.forEach((dataset, index) => {
                const controlLabel = document.createElement('label');
                controlLabel.className = 'flex items-center gap-2 bg-[#f3f7f2] px-3 py-1 rounded-full cursor-pointer text-sm text-gray-700 shadow-sm';

                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = true;
                checkbox.dataset.index = index;
                checkbox.className = 'form-checkbox h-4 w-4 text-[#4A7C59]';

                checkbox.addEventListener('change', (event) => {
                    const datasetIndex = parseInt(event.target.dataset.index, 10);
                    companyRadarChart.data.datasets[datasetIndex].hidden = !event.target.checked;
                    companyRadarChart.update();
                });

                const labelText = document.createElement('span');
                labelText.textContent = dataset.label;

                controlLabel.appendChild(checkbox);
                controlLabel.appendChild(labelText);
                radarControlsContainer.appendChild(controlLabel);
            });

        });
    </script>
</body>
</html>

